<% if @request.req_approval == "申請中" %>
<div class="relative-show-body">
  <div class="relative-container">
    <div class="relative-section">
      <nav class="level">
        <div class="level-left">
          <h1 class="has-text-weight-bold is-size-3"><%= @user.name %><span class="is-size-4 req-name"> 様からの申請</span></h1>
        </div>
        <div class="level-right">
          <div class="new-c-container">
            <%= form_with(url: relative_path(@request), method: :get, local: true) do |f| %>
              <div class="field is-grouped is-grouped-right">
                <div class="control has-icons-left">
                  <%= f.text_field :search, :placeholder => "入居者を入力..", class: "input is-rounded" %>
                  <span class="icon is-left">
                    <i class="fas fa-search" aria-hidden="true"></i>
                  </span>
                </div>
                <div class="control">
                  <%= f.submit "\uf002検索", class: "fa button is-light is-rounded" %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </nav>
      <div class="card">
        <table class="table is-narrow user-edit-table is-bordered" id="relative-table">
          <tbody>
            <tr>
              <th>利用者名</th>
              <td>
                <%= simple_format(@request.req_name) %>
              </td>
            </tr>
            <tr>
              <th>連絡先</th>
              <td>
                <%= simple_format(@request.req_phone) %>
              </td>
            </tr>
            <tr>
              <th>住所</th>
              <td>
                <%= simple_format(@request.req_address) %>
              </td>
            </tr>
            <tr>
              <th>紐付け</th>
              <td>
                <%= render partial: 'shared/error_messages', locals: { obj: @user } if @user.present? %>
                <%= form_with(model: @user, url: relative_path(user_id: @user), local: true) do |f| %>
                <div style="text-align: left; margin-top: 15px;">
                  <%= f.collection_check_boxes :resident_ids, @residents, :id, :name do |b| %>
                    <span class="r-check-box"><%= b.label { b.check_box + " " + b.text } %></span>
                  <% end %><br>
                </div>
                <div class="tag-apply">
                  <%= f.collection_check_boxes :resident_ids, @user.residents, :id, :name, style: 'display:none' do |b| %>
                    <span class="tag is-warning r-tag"><%= b.label { b.text } %>承認済</span>
                  <% end %>
                </div>
                <div class="propriety">
                  <%= f.submit "承認", class: "button is-primary is-light is-midium has-text-weight-bold", id: "approval-btn" %>
                  <%= link_to relative_path(denial: @request), method: :patch,
                    data: { confirm: "#{@user.name}の申請を否認してよろしいですか？" }, class:"button is-danger is-light is-medium", id:"denial-btn" do %>
                    否認
                  <% end %>
                </div>
                <% end %>
                  <%= link_to "問い合わせメールの作成", request_mail_preview_path(denial: @request), method: :get, class:"is-size-6" %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<% end %>
